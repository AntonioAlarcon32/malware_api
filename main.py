from flask import Flask, jsonify
from flask_socketio import SocketIO

app = Flask(__name__)
socketio = SocketIO(app)

# Initialize counters
endpoint1_counter = 0
endpoint2_counter = 0

@app.route('/counters', methods=['GET'])
def counters():
    return jsonify({"endpoint1_count": endpoint1_counter, "endpoint2_count": endpoint2_counter})


def update_counters():
    socketio.emit('update_counters', {'endpoint1_count': endpoint1_counter, 'endpoint2_count': endpoint2_counter})


@app.route('/endpoint1', methods=['GET'])
def endpoint1():
    global endpoint1_counter
    endpoint1_counter += 1
    update_counters()
    return jsonify({"message": "Endpoint 1 was called", "count": endpoint1_counter})


@app.route('/endpoint2', methods=['GET'])
def endpoint2():
    global endpoint2_counter
    endpoint2_counter += 1
    update_counters()
    return jsonify({"message": "Endpoint 2 was called", "count": endpoint2_counter})


if __name__ == "__main__":
    socketio.run(app, debug=True, host="0.0.0.0", port=3000, allow_unsafe_werkzeug=True)




